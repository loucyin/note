# mysql 

## 设计表的三大范式

1. 表中每一列的值都不能再拆分
2. 满足 1 ，并且除主键外每一列都必须依靠主键
3. 满足 2 ，并且除主键外每一列都不能相互依赖

## select * 与 select 所有列

- 如果是取所有列，在性能上没有任何差别
- 把所有列名列出来，会让代码易读
- 当表格修改，尤其删除列的时候，select 所有列会报错，需要修改代码适配，能避免一些潜在的问题
- 如果只需要某几个字段，select * 要多消耗资源，如果只需要一个带索引的字段，在执行时间上会有很大的差异

## mysql 优化

查询优化：

- 开启慢查询日志，收集慢查询的语句，通过 explain 分析慢查询语句，进行优化；
- 尽量避免全表扫描，在 where 以及 order by 涉及到的列上建立索引，或者联合索引，注意控制索引数量，否则会影响插入修改的效率；
- 不要使用 select * ,用到哪些字段，选择哪些字段
- 如果可以，尽可能不使用 null 

## 创建索引的原则

- 排序、分组、联合查询频率高的字段创建索引
- 索引数目不宜过多，过多会影响 insert update delete 效率

## 索引失效的条件

- 不在索引列上做操作
- 联合索引没有使用最左边的一列
- 使用不等于，is null 的时候
- like 以通配符开头的时候

## 聚簇索引和非聚簇索引

- 聚簇索引，将数据与索引放到一块儿，找到索引也就找到了数据
- 非聚簇索引，将数据与索引分开存储，索引的叶子节点，存储数据行的指针

聚簇索引特点：

- 聚簇索引对于主键的排序查找和范围查找速度快；
- 插入速度严重依赖于插入顺序，按照主键的插入是最快的方式，否则会出现页分裂，严重影响性能；
- 更新主键的代价很高，因为将会导致被更新的行移动；

非聚簇索引：

- 需要两次查找；
- 如果涉及到大数据量的排序、全表扫描、count 之类的操作的话，因为索引所占空间小，这些操作在内存中完成，效率要高。
