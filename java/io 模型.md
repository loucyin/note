# io 模型

## 同步异步 阻塞非阻塞

### 老张与水壶的故事（知乎上看到的）

老张有两把水壶，一把不响一把响；

- 老张拿不响的水壶烧水

  - 立等水开；（同步阻塞）
  - 去看电视，时不时的看一下水是否开了；（同步非阻塞）

- 老张拿响水壶烧水

  - 立等水开；（异步阻塞）
  - 去看电视，水壶响后，老张会去处理（异步非阻塞）

### 区别

- **同步异步与消息的通知机制有关**
- **阻塞非阻塞与等待消息时的状态有关**

## Linux io 模型

IO 操作的两个阶段 ： 等待数据，将数据从内核拷贝到用户空间；

- 同步阻塞 IO
- 同步非阻塞 IO
- IO 多路复用
- 信号驱动 IO
- 异步 IO 上面的四种模型在第二阶段都是阻塞的。

阻塞 IO | 非阻塞IO | IO 多路复用 | 信号驱动 IO | 异步IO
:---: | :---: | :-----: | :-----: | :--:
 发起   |  检查   |   检查    |         |  发起  | 第一阶段
 阻塞   |  检查   |   阻塞    |         |      |
 阻塞   |  检查   |  就绪发起   |  通知发起   |      |
 阻塞   |  阻塞   |   阻塞    |   阻塞    |      | 第二阶段
 完成   |  完成   |   完成    |   完成    |  通知  |

## java io nio nio2

### 流IO

流IO是最为基础也是最为广泛使用的IO方式，阻塞 IO

### NIO

NIO支持阻塞与非阻塞两种模式

### NIO2

需要由应用程序将数据读写到应用程序内存中的IO, 都是同步IO; 凡是由OS来完成读写的, 就是异步IO。 举例而言, 在NIO中, 当应用程序检测到某个Channel有可读数据时, 必须显示发起一个read请求。而在异步IO中, 应用程序仅仅需要告诉OS, 我需要什么数据, 并提供给OS一个Buffer和一个回调. OS会自己检测Channel的可读性, 但其发起其可读, 会自动将数据复制到Buffer中, 并通知应用程序任务完成。

## 参考链接

- [怎样理解阻塞非阻塞与同步异步的区别？](https://www.zhihu.com/question/19732473)
- [java IO 概念误区---------同步/异步与阻塞/非阻塞的区别](http://blog.csdn.net/kangojian/article/details/5710977)
- [Linux五种IO模型性能分析](http://blog.csdn.net/jay900323/article/details/18141217/)
- [Java IO & NIO & NIO2](http://www.jianshu.com/p/07d3d421a877)
